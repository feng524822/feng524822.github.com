(function(n){function t(a){return a.charAt(0).toUpperCase()+a.slice(1)}function h(a,b,c){var f,e,g,d;if(b instanceof Object)for(f in b)b.hasOwnProperty(f)&&arguments.callee(a,f,b[f]);else if(f=t(b),e=["Webkit","O","Moz","ms"],g=e.length,d=a.style,b in d)d[b]=c;else for(;g--;)if(b=e[g]+f,b in d){d[b]=c;break}}function p(a,b,c,f,e){p=a.addEventListener?function(a,b,c,f,e){a["e"+b+c]=c;a[b+c]=function(d){d.data=e;a["e"+b+c].call(f||n,d)};return a.addEventListener(b,a[b+c],!1)}:function(a,b,c,f,e){a["e"+
b+c]=c;a[b+c]=function(){var d=n.event;d.data=e;a["e"+b+c].call(f,d)};return a.attachEvent("on"+b,a[b+c])};p.apply(n,arguments)}function q(a,b,c){q=a.removeEventListener?function(a,b,c){return a.removeEventListener(b,a[b+c],!1)}:function(a,b,c){return a.detachEvent("on"+b,a[b+c])};q.apply(n,arguments)}function u(a,b,c,f){1===arguments.length&&q(a,r?"touchstart":"mousedown",s);p(a,r?"touchstart":"mousedown",s,null,{l:b,n:c,c:a,data:f})}function s(a){var b=a.data,c=document.documentElement.scrollLeft||
document.body.scrollLeft,f=document.documentElement.scrollTop||document.body.scrollTop;b.x=a.pageX||a.clientX+c;b.y=a.pageY||a.clientY+f;try{a.W=!1}catch(e){a.preventDefault()}switch(a.type){case "touchend":case "mouseup":b.type="endDrag";q(document,r?"touchmove":"mousemove",s);q(document,r?"touchend":"mouseup",s);b.l.call(b.n,b,a);break;case "touchmove":case "mousemove":b.type="moveDrag";b.i=b.x-b.offsetX;b.j=b.y-b.offsetY;b.l.call(b.n,b,a);break;case "mousedown":b.type="startDrag",b.offsetX=b.x,
b.offsetY=b.y,b.i=0,b.j=0,b.l.call(b.n,b)&&(p(document,r?"touchmove":"mousemove",s,null,b),p(document,r?"touchend":"mouseup",s,null,b))}}function v(a){this.m=a;this.g=100;this.padding=10;this.areas=[];this.d={};this.f=0;this.s()}var r="ontouchstart"in n||n.$&&document instanceof DocumentTouch,d=v.prototype;d.s=function(){this.K();this.D();this.F();this.C();this.start()};d.reset=function(){var a=this.d;this.Y();a.h.parentNode.removeChild(a.h);a.f.parentNode.removeChild(a.f);this.areas=[];this.d={};
this.f=0;this.s()};d.D=function(){var a="#f57 #a67 #7ba3e4 #9d7c1f #693465 #2c9d1f #1f4f9d #ae22a2 #e4e14d #32dee0 #c31c25".split(" ");this.r={};for(var b=0;b<a.length;b++)this.r[2<<b]=a[b]};d.K=function(){for(var a=0,b=[],c=0;4>c;c++){for(var f=[],e=0;4>e;e++)f.push(e),a++;b.push(f)}this.count=a;this.b=b};d.F=function(){this.J();this.L();this.H()};d.J=function(){var a=document.createElement("div");a.style.position="relative";this.m.appendChild(a);this.d.h=a;this.G();this.X()};d.X=function(){h(this.d.h,
{ca:"none",width:4*this.g+3*this.padding+"px",height:4*this.g+3*this.padding+"px"})};d.G=function(){for(var a,b=0;b<this.count;)a={index:b,a:0,c:null,B:null,left:b%4*(this.g+this.padding),top:Math.floor(b/4)*(this.g+this.padding)},this.areas.push(a),a.B=this.q(b,1),b++};d.q=function(a,b){var c=this.e(a),f=document.createElement("div");h(f,{position:"absolute",width:this.g+"px",height:this.g+"px",opacity:b?1:0,lineHeight:this.g+"px",textAlign:"center",borderRadius:"7px",left:c.left+"px",top:c.top+
"px",zIndex:!b+2,transition:"all 0.2s ease-in,opacity 0.4s linear",backgroundColor:"#fff5f5"});this.d.h.appendChild(f);return f};d.L=function(){var a=document.createElement("div");h(a,{width:"150px",height:"60px",lineHeight:"60px",fontWeight:"bold",borderRadius:"7px",background:"#272727",color:"#fff",textAlign:"center",fontSize:"24px",marginLeft:"auto",marginRight:"auto",marginTop:"20px"});this.d.f=a;this.m.appendChild(a)};d.H=function(){var a=this.d;a.control=document.createElement("div");this.m.appendChild(a.control);
h(a.control,{position:"absolute",right:"100px",bottom:"100px",width:"40px",height:"40px"});for(var a=["top","right","bottom","left"],b=0;b<a.length;b++)this.I(a[b])};d.I=function(a){var b=this.d,c=document.createElement("div");h(c,{width:"0",height:"0",position:"absolute",borderStyle:"solid",borderColor:"transparent",borderWidth:"20px"});var f={left:"right",top:"bottom"},e,g;for(g in f)f.hasOwnProperty(g)&&(g==a?e=f[g]:f[g]==a&&(e=g));h(c,e,"100%");h(c,"border"+t(e)+"Color","#333");h(c,"border"+t(e)+
"Width","40px");h(c,"border"+t(a)+"Width","0");b["ctrl"+a]=c;b.control.appendChild(c);p(c,"click",function(){this.dir=a.charAt(0);this.move()},this)};d.e=function(a){return this.areas[a]};d.ba=function(){var a=[];this.map(function(b){0===b.a&&a.push(b)});return a};d.Q=function(a){return 0===this.e(a).a};d.V=function(){var a=Math.floor(Math.random()*this.count);return this.Q(a)?a:arguments.callee.call(this)};d.map=function(a){for(var b=0;b<this.areas.length;b++)a.call(this,this.areas[b],b)};d.p=function(){var a=
2,b=this.V(),c=this.e(b),f=this.q(b);6.5<10*Math.random()&&(a=4);setTimeout(function(){h(f,"opacity",1)},20);h(f,{fontSize:"20px",color:"#fff"});c.a=a;c.c=f;this.w(b)};d.w=function(a){a=this.e(a);if(a.c)if(a.a){var b=a.c,c=a.a;try{b.innerText=c}catch(f){b.textContent=c}h(a.c,"background",this.r[a.a]||"#f47")}else this.d.h.removeChild(a.c);else a.a=0};d.v=function(){var a=this.d.f,b=this.f;try{a.innerText=b}catch(c){a.textContent=b}};d.N=function(){this.complete&&(n.alert("\u7ed3\u675f\u4e86\uff0c\u91cd\u65b0\u5f00\u59cb\u5427"),
this.reset(),n.aa=this)};d.O=function(){var a=!1;this.map(function(b){0===b.a&&(a=!0)});return a};d.M=function(){return this.P()||this.Z()};d.A=function(){var a=!1,b=this;hLayer.sort(function(c,f){var e=b.e(c),g=b.e(f);if(e.a===g.a&&2048>e.a&&2048>g.a||0===e.a||0===g.a)a=!0;return e.index-g.index});return a};d.P=function(){for(var a=!1,b=0;b<this.b.length;b++){for(var c=this.b[b],f=[],e=0;e<c.length;e++)f.push(b*c.length+e);if(this.A()){a=!0;break}}return a};d.Z=function(){for(var a=!1,b=0;b<this.b.length;b++){for(var c=
this.b[b],f=[],e=0;e<c.length;e++)f.push(e*c.length+b);if(this.A()){a=!0;break}}return a};d.C=function(){u(this.d.h,this.DragEvent,this);p(document,"keydown",this.t,this)};d.Y=function(){u(this.d.h);q(document,"keydown",this.t)};d.t=function(a){var b=a.keyCode||a.charCode||a.which;try{a.W=!1}catch(c){a.preventDefault()}switch(b){case 37:this.dir="l";break;case 38:this.dir="t";break;case 39:this.dir="r";break;case 40:this.dir="b"}this.move()};d.DragEvent=function(a){switch(a.type){case "endDrag":this.dir=
0<=Math.abs(a.i)-Math.abs(a.j)?0<a.i?"r":"l":0<a.j?"b":"t";(30<Math.abs(a.i)||30<Math.abs(a.j))&&this.move();document.body.style.cursor="default";break;case "moveDrag":document.body.style.cursor="move"}return!0};d.move=function(){if(this.u)return!1;this.u=!0;this.o=0;switch(this.dir){case "l":this.S();break;case "r":this.T();break;case "t":this.U();break;case "b":this.R()}this.moveEnd()};d.moveEnd=function(){this.v();this.O()?this.o&&(this.p(),this.complete=!this.M()):this.complete=!0;this.N();this.u=
!1;this.dir=null;this.o=0};d.S=function(){for(var a,b,c,f,e,g,d,h,k=0;k<this.b.length;k++){h=this.b[k];e=f=-1;c=0;d=!1;b=this.b.length*k;for(var l=0;l<h.length;l++)a=b+l,g=this.e(a),g=g.a,e===g&&2048>g&&(c++,d=!0),0===f&&c++,g&&(e=g),d&&(e=-1,user=!1),f=g,this.k(a,Math.max(b,a-c))}};d.T=function(){for(var a,b,c,f,e,d,h,m,k=0;k<this.b.length;k++){m=this.b[k];e=f=-1;c=0;h=!1;b=m.length*(k+1)-1;for(var l=0;l<m.length;l++)a=b-l,d=this.e(a),d=d.a,e===d&&2048>d&&(c++,h=!0),0===f&&c++,d&&(e=d),f=d,h&&(e=
-1,user=!1),this.k(a,Math.min(b,a+c))}};d.U=function(){for(var a,b,c,f,d,g,h,m,k=0;k<this.b.length;k++){m=this.b[k];d=f=-1;c=0;h=!1;b=k;for(var l=0;l<m.length;l++)a=l*this.b.length+b,g=this.e(a),g=g.a,d===g&&2048>g&&(c+=this.b.length,h=!0),0===f&&(c+=this.b.length),g&&(d=g),f=g,h&&(d=-1,user=!1),this.k(a,Math.max(b,a-c))}};d.R=function(){for(var a,b,c,d,e,g,h,m,k=0;k<this.b.length;k++){m=this.b[k];e=d=-1;c=0;h=!1;b=(this.b.length-1)*m.length+k;for(var l=0;l<m.length;l++)a=b-l*this.b.length,g=this.e(a),
g=g.a,e===g&&2048>g&&(c+=this.b.length,h=!0),0===d&&(c+=this.b.length),g&&(e=g),d=g,h&&(e=-1,user=!1),this.k(a,Math.min(b,a+c))}};d.k=function(a,b){var c=this.e(a),d=this.e(b);if(a!==b&&c.c){d.a+=c.a;if(d.c){var e=d.c;setTimeout(function(){e.parentNode.removeChild(e);e=null},200);this.f+=d.a}d.c=c.c;h(d.c,{left:d.left+"px",top:d.top+"px"});c.c=null;c.a=0;this.w(b);this.o++}};d.start=function(){this.p();this.p();this.v()};n.h2048=function(a){return new v(a)}})(window);